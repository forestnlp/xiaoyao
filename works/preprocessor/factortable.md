# factortable 指标字段说明文档

## 文档说明

本文档针对 `factortable.parquet` 文件中的所有指标字段进行详细说明，包括字段名称、指标类型、计算逻辑及业务含义，为后续量化分析、策略开发提供字段解读依据。

## 一、基础字段（原始数据保留字段）



| 字段名称            | 类型  | 说明                       |
| --------------- | --- | ------------------------ |
| stock\_code     | 字符串 | 股票代码（唯一标识单只股票，为分组计算的核心键） |
| date            | 日期  | 数据对应的交易日日期               |
| open            | 数值  | 当日开盘价                    |
| close           | 数值  | 当日收盘价（多数指标的核心计算基础）       |
| high            | 数值  | 当日最高价                    |
| low             | 数值  | 当日最低价                    |
| volume          | 数值  | 当日成交量                    |
| money           | 数值  | 当日成交金额                   |
| pre\_close      | 数值  | 前一交易日收盘价（用于计算振幅等指标）      |
| auc\_volume     | 数值  | 当日竞价成交量                  |
| turnover\_ratio | 数值  | 当日换手率（%）                 |
| b1\_v\~b5\_v    | 数值  | 买一至买五档位的挂单量（盘口数据）        |
| a1\_v\~a5\_v    | 数值  | 卖一至卖五档位的挂单量（盘口数据）        |

## 二、趋势类指标

### 2.1 移动平均线（MA/EMA）



| 字段名称  | 计算逻辑                  | 业务含义                           |
| ----- | --------------------- | ------------------------------ |
| ma5   | TA-Lib.SMA(close, 5)  | 5 日简单移动平均线，反映短期趋势              |
| ma10  | TA-Lib.SMA(close, 10) | 10 日简单移动平均线，反映短期趋势             |
| ma20  | TA-Lib.SMA(close, 20) | 20 日简单移动平均线，反映中期趋势             |
| ma60  | TA-Lib.SMA(close, 60) | 60 日简单移动平均线，反映长期趋势             |
| ema12 | TA-Lib.EMA(close, 12) | 12 日指数移动平均线（加权侧重近期价格），反映短期趋势变化 |
| ema26 | TA-Lib.EMA(close, 26) | 26 日指数移动平均线，反映中期趋势变化           |

### 2.2 MACD（指数平滑异同移动平均线）



| 字段名称               | 计算逻辑                                  | 业务含义                            |
| ------------------ | ------------------------------------- | ------------------------------- |
| macd\_line\_calc   | EMA12 - EMA26                         | MACD 主线，反映短期与中期趋势的差值            |
| signal\_line\_calc | TA-Lib.EMA(macd\_line\_calc, 9)       | MACD 信号线（9 日 EMA 平滑），用于产生买卖信号   |
| macd\_hist\_calc   | macd\_line\_calc - signal\_line\_calc | MACD 柱状图，反映主线与信号线的差值（红柱看涨，绿柱看跌） |

### 2.3 DMA（平行线差）



| 字段名称        | 计算逻辑                                          | 业务含义                               |
| ----------- | --------------------------------------------- | ---------------------------------- |
| dma         | TA-Lib.EMA(close, 10) - TA-Lib.EMA(close, 50) | DMA 主线，反映短期与长期趋势的差值，判断中长期趋势方向      |
| dma\_signal | TA-Lib.EMA(dma, 10)                           | DMA 信号线（10 日 EMA 平滑），与主线交叉产生趋势确认信号 |

### 2.4 TRIX（三重指数平滑平均线）



| 字段名称         | 计算逻辑                   | 业务含义                             |
| ------------ | ---------------------- | -------------------------------- |
| trix         | TA-Lib.TRIX(close, 12) | TRIX 主线，通过三重 EMA 平滑过滤噪音，反映长期趋势强度 |
| trix\_signal | TA-Lib.EMA(trix, 9)    | TRIX 信号线（9 日 EMA 平滑），与主线交叉确认趋势反转 |

### 2.5 其他趋势辅助指标



| 字段名称        | 计算逻辑                                      | 业务含义                                 |
| ----------- | ----------------------------------------- | ------------------------------------ |
| momentum14  | close - close.shift(14)                   | 14 日动量指标，反映价格在 14 个交易日内的绝对变动幅度       |
| roc10       | TA-Lib.ROC(close, 10)                     | 10 日价格变动率（%），反映价格相对涨跌速度              |
| ma20\_slope | (ma20 - ma20.shift(1))/ma20.shift(1)\*100 | 20 日均线斜率（%），反映中期趋势的变化速率（正斜率看涨，负斜率看跌） |

## 三、震荡类指标

### 3.1 RSI（相对强弱指数）



| 字段名称  | 计算逻辑                  | 业务含义                                |
| ----- | --------------------- | ----------------------------------- |
| rsi6  | TA-Lib.RSI(close, 6)  | 6 日 RSI，反映短期市场超买超卖状态（>70 超买，<30 超卖） |
| rsi14 | TA-Lib.RSI(close, 14) | 14 日 RSI，标准周期指标，平衡灵敏度与稳定性           |
| rsi21 | TA-Lib.RSI(close, 21) | 21 日 RSI，反映中长期市场强弱状态                |

### 3.2 KDJ（随机指标）



| 字段名称   | 计算逻辑                                  | 业务含义                                |
| ------ | ------------------------------------- | ----------------------------------- |
| kdj\_k | TA-Lib.STOCH(high, low, close, 9,3,0) | K 值（快速随机指标），反映短期价格波动位置              |
| kdj\_d | TA-Lib.STOCH(high, low, close, 9,3,0) | D 值（慢速随机指标），对 K 值平滑（3 日移动平均），产生交叉信号 |
| kdj\_j | 3*kdj\_k - 2*kdj\_d                   | J 值，反映 K、D 差值的极端状态（>100 超买，<0 超卖）   |

### 3.3 成交量加权 RSI（VI）



| 字段名称       | 计算逻辑                                       | 业务含义                                |
| ---------- | ------------------------------------------ | ----------------------------------- |
| vol\_rsi14 | TA-Lib.RSI(close\*volume/volume.sum(), 14) | 14 日成交量加权 RSI，结合量价关系判断震荡强度（量价同步更可靠） |

## 四、波动类指标

### 4.1 布林带（Bollinger Bands）



| 字段名称                   | 计算逻辑                               | 业务含义                                      |
| ---------------------- | ---------------------------------- | ----------------------------------------- |
| bollinger\_upper\_calc | TA-Lib.BBANDS (close,20,2,2,0)（上轨） | 布林带上轨（20 日 SMA+2 倍标准差），反映价格波动上限（突破可能延续趋势） |
| bollinger\_mid\_calc   | TA-Lib.BBANDS (close,20,2,2,0)（中轨） | 布林带中轨（20 日 SMA），即中期趋势线                    |
| bollinger\_lower\_calc | TA-Lib.BBANDS (close,20,2,2,0)（下轨） | 布林带下轨（20 日 SMA-2 倍标准差），反映价格波动下限（突破可能反转）   |

### 4.2 ATR（平均真实波幅）



| 字段名称  | 计算逻辑                             | 业务含义                              |
| ----- | -------------------------------- | --------------------------------- |
| atr14 | TA-Lib.ATR(high, low, close, 14) | 14 日平均真实波幅，衡量价格波动的绝对幅度（值越大，波动性越强） |

### 4.3 自定义波动率与标准差



| 字段名称         | 计算逻辑                               | 业务含义                             |
| ------------ | ---------------------------------- | -------------------------------- |
| volatility   | (high-low)/open.rolling(20).mean() | 20 日平均波动率（基于当日振幅），反映价格相对波动强度     |
| price\_std20 | TA-Lib.STDDEV(close, 20, 1)        | 20 日价格标准差，量化价格波动的离散程度（值越大，波动越剧烈） |

### 4.4 最大回撤



| 字段名称                        | 计算逻辑                                                                        | 业务含义                                 |
| --------------------------- | --------------------------------------------------------------------------- | ------------------------------------ |
| rolling\_max\_drawdown\_20d | (close - close.rolling(20).max())/close.rolling(20).max().rolling(20).min() | 20 日滚动最大回撤（%），反映短期下跌风险（负值，绝对值越大风险越高） |

## 五、量价类指标

### 5.1 VWAP（成交量加权平均价格）



| 字段名称 | 计算逻辑                                       | 业务含义                                |
| ---- | ------------------------------------------ | ----------------------------------- |
| vwap | (money/volume).cumsum()/np.arange(1,len+1) | 累计成交量加权平均价格，反映当日市场成交的平均成本（机构常用参考指标） |

### 5.2 OBV（能量潮）及衍生指标



| 字段名称       | 计算逻辑                               | 业务含义                                   |
| ---------- | ---------------------------------- | -------------------------------------- |
| obv        | 当日涨则 + volume，跌则 - volume，平则不变（累积） | 能量潮指标，通过成交量与价格关系判断资金流向（OBV 上升价格未涨可能看涨） |
| obv\_ema10 | TA-Lib.EMA(obv, 10)                | OBV 的 10 日 EMA 平滑线，过滤短期波动，确认资金流向趋势     |

### 5.3 量能对比指标



| 字段名称                              | 计算逻辑                                                 | 业务含义                           |
| --------------------------------- | ---------------------------------------------------- | ------------------------------ |
| volume\_ratio\_vs\_yesterday      | volume / volume.shift(1)                             | 成交量较昨日比值，反映当日量能变化（>1 放量，<1 缩量） |
| volume\_ratio\_vs\_5d\_avg        | volume / volume.rolling(5).mean().shift(1)           | 成交量较 5 日均值比值，反映量能相对强弱          |
| auc\_volume\_ratio\_vs\_yesterday | auc\_volume / auc\_volume.shift(1)                   | 竞价成交量较昨日比值，反映开盘前资金活跃度          |
| auc\_volume\_ratio\_vs\_5d\_avg   | auc\_volume / auc\_volume.rolling(5).mean().shift(1) | 竞价成交量较 5 日均值比值，反映开盘资金热度相对水平    |
| volume\_ratio                     | volume / volume.rolling(5).mean()                    | 成交量与 5 日均值比值，实时反映量能偏离程度        |

### 5.4 资金流向指标



| 字段名称                   | 计算逻辑                          | 业务含义                   |
| ---------------------- | ----------------------------- | ---------------------- |
| buy\_total             | b1\_v+b2\_v+b3\_v+b4\_v+b5\_v | 买一至买五挂单总量，反映下方支撑力度     |
| sell\_total            | a1\_v+a2\_v+a3\_v+a4\_v+a5\_v | 卖一至卖五挂单总量，反映上方压力力度     |
| main\_force\_net\_flow | buy\_total - sell\_total      | 盘口主力净流入（估算），反映短期资金买卖方向 |

## 六、盘口与活跃度指标

### 6.1 盘口订单结构指标



| 字段名称                       | 计算逻辑                                                                               | 业务含义                             |
| -------------------------- | ---------------------------------------------------------------------------------- | -------------------------------- |
| order\_book\_volume\_ratio | buy\_total / sell\_total                                                           | 盘口买卖量比，反映多空力量对比（>1 多头占优，<1 空头占优） |
| obv\_ratio\_vs\_yesterday  | order\_book\_volume\_ratio / order\_book\_volume\_ratio.shift(1)                   | 盘口量比相对昨日变化，反映多空力量变化趋势            |
| obv\_ratio\_vs\_5d\_avg    | order\_book\_volume\_ratio / order\_book\_volume\_ratio.rolling(5).mean().shift(1) | 盘口量比相对 5 日均值变化，反映当前多空强度偏离常态程度    |

### 6.2 市场活跃度指标



| 字段名称                           | 计算逻辑                                                         | 业务含义                         |
| ------------------------------ | ------------------------------------------------------------ | ---------------------------- |
| amplitude                      | (high-low)/pre\_close\*100                                   | 当日振幅（%），反映价格日内波动剧烈程度         |
| amplitude\_vs\_yesterday       | amplitude / amplitude.shift(1)                               | 振幅较昨日比值，反映日内波动变化趋势           |
| amplitude\_vs\_5d\_avg         | amplitude / amplitude.rolling(5).mean().shift(1)             | 振幅较 5 日均值比值，反映当前波动强度是否异常     |
| turnover\_ratio\_vs\_yesterday | turnover\_ratio / turnover\_ratio.shift(1)                   | 换手率较昨日比值，反映市场交易活跃度变化         |
| turnover\_ratio\_vs\_5d\_avg   | turnover\_ratio / turnover\_ratio.rolling(5).mean().shift(1) | 换手率较 5 日均值比值，反映当前交易热度相对水平    |
| money\_ratio\_vs\_yesterday    | money / money.shift(1)                                       | 成交金额较昨日比值，反映资金参与度变化          |
| money\_ratio\_vs\_5d\_avg      | money / money.rolling(5).mean().shift(1)                     | 成交金额较 5 日均值比值，反映当前资金热度偏离常态程度 |

## 七、量价结构指标



| 字段名称                      | 计算逻辑                                                        | 业务含义                                      |
| ------------------------- | ----------------------------------------------------------- | ----------------------------------------- |
| price\_volume\_divergence | \[(close/close.shift(5)-1)-(volume/volume.shift(5)-1)]\*100 | 5 日量价背离值（%），反映价格与成交量涨幅差异（正值：价涨量缩；负值：价跌量增） |

## 八、异常值说明



* 所有数值型字段已通过 `replace([np.inf, -np.inf], np.nan)` 处理无穷值，缺失值（`nan`）主要源于：

1. 滚动窗口计算的前 N 个值（如 MA5 前 4 日、RSI14 前 13 日）；

2. 分母为 0 的情况（如成交量为 0 时的量比计算）；

3. 价格无波动时的指标失效（如 RSI 在价格横盘时无意义）。

要不要我帮你整理一份**factortable 指标字段说明表（Excel 格式）** ？方便你后续在策略开发时快速查阅字段含义和计算逻辑。

> （注：文档部分内容可能由 AI 生成）